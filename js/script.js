const select=document.querySelector("select"),allLang=["en","ru","kz"],userInput='<script>alert("XSS")</script>',escapeHtml=e=>e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),div=document.createElement("div");div.textContent=escapeHtml('<script>alert("XSS")</script>'),document.body.appendChild(div),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("toggleButton"),t=document.getElementById("fullMenu"),n=document.getElementById("buttonText");t.style.display="none",e.addEventListener("click",()=>{"none"===t.style.display?(t.style.display="block",n.textContent="Скрыть меню"):(t.style.display="none",n.textContent="Показать меню")})});let lastActiveIndex=-1,isScrollingByClick=!1;function onScroll(){if(isScrollingByClick)return;let e=document.querySelectorAll(".button-container .category"),t=document.querySelectorAll(".categorys"),n=document.querySelector(".button-container"),r=-1;t.forEach((e,t)=>{let n=e.getBoundingClientRect();n.top<=window.innerHeight/2&&n.bottom>=window.innerHeight/2&&(r=t)}),-1!==r&&r!==lastActiveIndex&&(e.forEach((e,t)=>{if(t===r){e.classList.add("active-category");let l=e.offsetLeft-n.offsetLeft-10;n.scrollTo({left:l,behavior:"smooth"})}else e.classList.remove("active-category")}),lastActiveIndex=r)}document.addEventListener("scroll",onScroll),document.querySelectorAll(".button-container .category").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("href").substring(1),n=document.getElementById(t);n&&(isScrollingByClick=!0,window.scrollTo({top:n.offsetTop,behavior:"smooth"}),setTimeout(()=>{isScrollingByClick=!1,onScroll()},100))})}),document.getElementById("scrollToTopButton").addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})});let order=[],currentKuyrdakItem=null;function addToOrder(e){if("Қуырдақ баранина/говядина/конина"===e)currentKuyrdakItem=e,document.getElementById("kuyrdak-modal").style.display="flex",document.body.classList.add("modal-open"),setTimeout(setDefaultKuyrdakOption,10);else{let t=order.find(t=>t.name===e);t?t.quantity+=1:order.push({name:e,quantity:1}),updateOrderList(),updateCartCounter()}}function setDefaultKuyrdakOption(){let e=document.querySelector('.kuyrdak-option[data-value="баранина"]');e&&selectKuyrdakOption(e)}function selectKuyrdakOption(e){let t=document.querySelectorAll(".kuyrdak-option");t.forEach(e=>e.classList.remove("active")),e.classList.add("active"),currentKuyrdakItem=e.dataset.value}function confirmKuyrdakSelection(){if(currentKuyrdakItem){let e=`Қуырдақ ${currentKuyrdakItem}`,t=order.find(t=>t.name===e);t?t.quantity+=1:order.push({name:e,quantity:1}),updateOrderList(),updateCartCounter(),closeKuyrdakModal()}else alert("Пожалуйста, выберите вариант.")}function closeKuyrdakModal(){document.getElementById("kuyrdak-modal").style.display="none",document.body.classList.remove("modal-open")}function updateOrderList(){let e=document.getElementById("order-list");e.innerHTML="",order.forEach((t,n)=>{let r=document.createElement("li");r.textContent=`${t.name}: ${t.quantity}`;let l=document.createElement("button");l.textContent="-",l.addEventListener("click",()=>changeQuantity(n,-1)),r.appendChild(l);let a=document.createElement("button");a.textContent="+",a.addEventListener("click",()=>changeQuantity(n,1)),r.appendChild(a);let o=document.createElement("button");o.textContent="Убрать",o.addEventListener("click",()=>removeFromOrder(n)),r.appendChild(o),e.appendChild(r)})}function changeQuantity(e,t){order[e].quantity+t>0?order[e].quantity+=t:removeFromOrder(e),updateOrderList(),updateCartCounter()}function removeFromOrder(e){order.splice(e,1),updateOrderList(),updateCartCounter()}function clearOrder(){order=[],updateOrderList(),updateCartCounter()}function updateCartCounter(){let e=document.getElementById("cart-counter"),t=order.reduce((e,t)=>e+t.quantity,0);e.textContent=t}function toggleCart(){let e=document.getElementById("cart-modal"),t="block"===e.style.display;t?(e.classList.add("hide"),setTimeout(()=>{e.style.display="none",e.classList.remove("hide"),document.body.classList.remove("modal-open")},300)):(e.style.display="block",document.body.classList.add("modal-open"))}function changeURLLanguage(){let e=select.value;location.href=window.location.pathname+"#"+e,location.reload()}function changeLanguage(){let e=window.location.hash;for(let t in e=e.substr(1),allLang.includes(e)||(location.href=window.location.pathname+"#ru",location.reload()),select.value=e,document.querySelector("title").innerHTML=langArr.unit[e],langArr){let n=document.querySelector(".lng-"+t);n&&(n.textContent=langArr[t][e])}}select.addEventListener("change",changeURLLanguage),changeLanguage();